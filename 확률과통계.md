**확률과 통계 정리**



< 확률 변수 & 확률 분포 & 확률 함수 >

- 변수 : 특정 조건에 따라 변하는 값

- 확률 변수 (Random variable) : 무작위 실험을 했을 때, 특정 확률로 발생하는 각각의 결과를 수치적 값으로 표현하는 변수 

ex)  동전을 무작위로 두 번 던져서 그림 또는 숫자가 나오는 실험에서 앞면이 나올 확률 1/2, 그리고 뒷면이 나올 확률 1/2을 가지고 발생하는 결과에 실수 값을 부여하는 변수를 말함



* 확률 변수의 종류 *

1. 이산확률 변수 (discrete random variable)

: 확률 변수 X가 어느 구간의 모든 실수 값을 택하지 않고, 0, 1, 2, ...와 같은 고립된 값만을 택하는 변수

: discrete -> "별개의", "분리된"으로 해석

: 상태공간이 유한 집합 또는 셈할 수 있는 무한 집합인 확률 변수 

: ex) 동전 던지기 게임이나 주사위 던지기 게임


2. 연속확률 변수 (Continuous random variable)

: 확률 변수가 취하는 값이 연속된 구간으로 나타나는 확률 변수

: 정규분포가 대표적인 연속확률 변수 



* 이산확률 변수 VS  연속확률 변수 *

<img width="271" alt="image" src="https://user-images.githubusercontent.com/87634136/178137501-2e9363a2-31da-4ecd-9bb1-3448ecb7e433.png">


- 확률 분포 (Probability distribution)

: 확률 변수의 모든 값과 그에 대응하는 확률들이 어떻게 분포하고 있는지


- 확률 함수 (Probability function) 

: 확률 변수에 의해 정의된 실수를 확률 (0 ~ 1)에 대응시키는 함수

ex) 

동전을 두 번 던져서 그림이 나오는 확률 변수 -> X

각 상태 공간 값이 나올 확률 분포 ?

x = 0, 1, 2

<img width="272" alt="image" src="https://user-images.githubusercontent.com/87634136/178137511-756b586f-0bdb-45df-9d96-a4393221b998.png">

-> 특정 확률 변수의 확률 함수를 알고 있으면 특정 사건이 일어날 확률을 계산할 수 있다.

-> 연속확률 변수 & 분포함수 

==> 알고 싶은 사건이 발생하는 구간의 넓이 계산 => 사건 발생 확률 예측

<img width="184" alt="image" src="https://user-images.githubusercontent.com/87634136/178137550-7352bbb8-d804-4f6a-9cd8-c02375f142be.png">




< 결합 확률 & 주변 확률 & 조건부 확률 >

<img width="118" alt="image" src="https://user-images.githubusercontent.com/87634136/178137560-928e6563-a2e5-4aad-a644-b1d22972f14b.png">


- 결합 확률 (Joint Probability)

: 두 개의 사건이 동시에 일어날 확률

: 서로 배반되는 두 사건 A, B가 있을 때, 두 사건이 동시에 일어나는 확률을 P(A∩B) 라고 하며,

이 확률을 A, B의 결합확률


ex) 동전을 던지는 실험

- 첫 번째 동전을 던지는 사건 : A

- 두 번째 동전을 던지는 사건 : B

- A, B는 동시에 일어날 수 없음 -> 상호 배반

<img width="214" alt="image" src="https://user-images.githubusercontent.com/87634136/178137579-a6c60fb3-d124-45bd-ad0f-e3dd0984431a.png">

--> 경우의 수 : 4가지

-> 앞면 : 1 / 뒷면 : 0 => A와 B사건을 X, Y라는 확률변수로 변환

<img width="173" alt="image" src="https://user-images.githubusercontent.com/87634136/178137593-014d2a93-132b-4a6a-8141-2c495ba2e210.png">

--> 위의 각각의 사건이 나타날 확률은 서로 독립 => P(A∩B)=P(A) · P(B) 만족

--> 결과 : 각각의 결합확률 1/4


- 주변 확률 (Marginal Probability) or 한계 확률

: 개별 사건의 확률이지만, 결합사건들의 합으로 표시될 수 있는 확률

<img width="360" alt="image" src="https://user-images.githubusercontent.com/87634136/178137609-3b00d85b-018b-41a6-b901-a48d95005296.png">

--> 노란 배경 : 결합 확률 / 연두색 배경 : 주변확률

: 위 확률 변수의 결합 분포를 기록한 테이블에서 주변에 위치한 확률

: X = 0으로 고정할 때 => P(X=0, Y=0) + P(X=0, Y=1) = P(X=0)

: X는 고정되었지만 Y의 값은 계속 변함

: 위의 확률은 Y=y의 값에 관계 없이 X=0인 주변확률이라고 표현

<img width="146" alt="image" src="https://user-images.githubusercontent.com/87634136/178137618-1a225413-f411-4480-b31c-c92f6d423eb6.png">

- 조건부 확률 (Conditional Probability)

: 특정한 주어진 조건 하에서 어떤 사건이 발생할 확률

: 어떤 사건 A가 일어났다는 전제 하에 사건 B가 발생할 확률이라고 할 수 있다.


ex) 사건 A의 확률

N개의 원소가 있는 표본공간 U에서 각 근원 사건 w가 일어날 가능성이 동일하다면,

k개의 원소로 구성된 사건 A의 확률은 k/N

-> 확률을 정의할 때 분모에 표본공간의 원소의 개수가 들어감


조건부 확률은 어떠한 사건 A가 일어났다는 전제 하에 확률을 정의하므로,

이때 표본공간은 A의 근원사건 k개로 이루어진 표본공간으로 재정의 됨


어떤 사건 A가 일어났다는 전제 하에서 사건 B가 발생할 확률인 조건부확률은

P(B|A) = P(A∩B)/P(A) 

-> 분자 : A와 B의 결합 확률 / 분모 : 사건 A의 확률


- 결합 확률 & 주변 확률 & 조건부 확률의 관계

<img width="211" alt="image" src="https://user-images.githubusercontent.com/87634136/178137645-d4bcdd5d-6e98-4128-80f6-3f6af32cd230.png">

< 베이즈 공식 >

<img width="254" alt="image" src="https://user-images.githubusercontent.com/87634136/178137654-aef29a98-89e0-417b-a443-f109cf874f1e.png">

- 어떤 사건 A와 다른 어떤 사건 B에 대한 조건부 확률 P(A | B)

- 어떤 사건 A에 대한 조건부 확률 P(B | A)

: P(B | A)는 사건 A가 발생하였을 때, 사건 B가 발생할 확률

: 선후 관계를 따져보면 A가 먼저 발생하고, 이후 B가 발생할 확률 => 인과관계

: A->B (A : 독립변수 / B : 종속변수)


- A->B와 B->A는 다름


: 우리가 알고 있는 정보 A->B를 바탕으로 B->A의 관계의 정도를 추론 할 수 있게 해주는 것

: 사전에 A에 대한 정보를 바탕으로 P(A)와 P(B | A)를 알고 있다면, 이를 활용해 P(A | B)를 추론할 수 있게 해주는 것

- 우리가 알고 있는 것은 P(B | A) = P(A∩B) / P(A) 인데 P(A | B)는 ? 


- P(A | B) = P(A∩B) / P(B)

-> P(B | A) : 사건 A가 발생했을 때 사건 B가 발생할 확률 (=우도(Likelihood))

-> 우도 : 어떤 시행의 결과 E가 주어졌을 때, 주어진 가설 H가 참이라면 E가 나올 가능성은 얼마나 될까라는 의미

-> P(B) = P(A∩B) = P(A1∩B) + P(A2∩B) + P(A3∩B) + P(A4∩B)

<img width="299" alt="image" src="https://user-images.githubusercontent.com/87634136/178137681-15f2159d-72a2-4978-a009-eb5305fc7c12.png">

--> P(B) : 주변 우도 (Marginal Likelihood)

->  P(Ai | B) : 사후 확률 (Posterior Probability)

<img width="280" alt="image" src="https://user-images.githubusercontent.com/87634136/178137698-09a3821f-e1ab-43ca-af7f-6c99f9bbe2ca.png">



< 확률분포표 & 확률 질량 함수 & 기댓값 & 분산 >

ex) 주사위를 다섯 번 던졌을 때, 1이 나오는 횟수

- 다섯 번 던졌으므로 1이 나올 수 있는 횟수는 : 0, 1, 2, 3, 4, 5

- 각 확률을 식으로 나타내면 

<img width="199" alt="image" src="https://user-images.githubusercontent.com/87634136/178137710-6e0beac3-fdb9-4f25-b5cb-c71c3f2b8e94.png">

--> 확률질량함수 (probability mass function)

- 표로 나타내면

<img width="356" alt="image" src="https://user-images.githubusercontent.com/87634136/178137724-71b0cc3c-65a8-4161-8651-86c71f4f4568.png">

--> 확률분포표 : 확률 질량함수를 표로 나타낸 것

<img width="194" alt="image" src="https://user-images.githubusercontent.com/87634136/178137744-d0860392-01f7-421a-ab67-1dac1b2d4783.png">

- 평균과 분산의 성질 

<img width="234" alt="image" src="https://user-images.githubusercontent.com/87634136/178137754-4716ddc9-652f-436f-8850-18b12d38bee2.png">

- 이항분포 (binomial distribution)

<img width="287" alt="image" src="https://user-images.githubusercontent.com/87634136/178137778-179b9664-9090-40a6-aac3-c85d92dc84c7.png">



< 독립 동일 분포 >

- 조건

: 각각의 분포 (주변 분포)는 모두 같다

: 모두 독립이다.

--> 위의 조건을 만족하면 독립 동일 분포에 따른다.

- 독립 동일 분포 (independent and identically distributed) => 줄여서 i.i.d 라고 함


< 큰 수의 법칙 >

<img width="262" alt="image" src="https://user-images.githubusercontent.com/87634136/178137802-b6008fa2-35b9-4702-91a5-c8ea76c2e4a4.png">


< 조건부 분산 >

<img width="185" alt="image" src="https://user-images.githubusercontent.com/87634136/178137840-280650bd-32b1-4455-ad49-9f284988619d.png">


< 확률밀도함수 >

: 확률밀도함수 f(x)

: 어떤 확률변수의 크기를 나타내는 값 

(확률질량함수도 마찬가지 ; 단지 확률 변수가 이산인지 연속인지만 다를뿐)

: 확률밀도함수 그래프의 넓이 : a와 b 사이의 확률을 구하는 것 

: 그래프의 넓이 -> 적분 이용

<img width="268" alt="image" src="https://user-images.githubusercontent.com/87634136/178137858-251f1345-04f6-4a82-bc1d-4fe733e613f9.png">

ex)

<img width="193" alt="image" src="https://user-images.githubusercontent.com/87634136/178137874-fdfc0b9b-676f-43cb-a426-5d86b3cff95e.png">


< 균등분포 >

: 연속형 분포에서 가장 단순한 분포형태로 특정구간 내의 값들이 나타날 가능성이 균등한 분포를 말한다.

: 연속형 확률변수 X가 실수구간 [a, b]에서 나타날 가능성이 균등할 때, X는 균등 분포를 따른다고 하며 X~U(a, b)로 표현한다.

: X의 확률 밀도 함수는?

<img width="224" alt="image" src="https://user-images.githubusercontent.com/87634136/178137890-11cf505c-a4fe-47ff-9519-49ebaea9917d.png">


* 균등 분포의 평균과 분산 *

: 확률변수 X가 X ~ U (a, b) 라고 할 때, X의 평균과 분산은 다음과 같다.

<img width="155" alt="image" src="https://user-images.githubusercontent.com/87634136/178137897-ee3f1f69-7c69-4ea2-b240-43ca8e8a4b47.png">


* 균등 분포의 확률 계산 *

<img width="173" alt="image" src="https://user-images.githubusercontent.com/87634136/178137909-4976bddd-c127-405b-bba6-7b7b4a51363b.png">



< 결합분포 & 주변분포 & 조건부분포 >

<img width="265" alt="image" src="https://user-images.githubusercontent.com/87634136/178137925-498bbebc-bc3c-4c34-9601-c56b446f0673.png">


< 공분산 & 상관계수 >

- 확률변수 X가 있을 때, 이 분포를 나타낼 때 쓰는 것

: 평균 -> 분포의 중간부분을 알아냄 

: 분산 -> 얼마나 퍼져있는지 알아냄


- 확률 변수가 2가지 일 때, 이 확률분포들이 어떤 모양인지 알고 싶을 때?

: X의 평균 -> Y의 평균

--> 대략적으로 분포가 어디에 주로 모여있는지 (m_x, m_y)가 나옴


- 공분산 (Covariance) 

: 각 확률변수들이 어떻게 퍼져있는지를 나타내는 것

: 두 확률변수 X와 Y가 어떤 모양으로 퍼져 있는지

: X가 커지면 Y도 커지거나 or 작어자거나 or 상관 업거나 등을 나타내주는 것

<img width="268" alt="image" src="https://user-images.githubusercontent.com/87634136/178137942-984ae426-40d9-45a6-b201-900aafc6170f.png">


- 공분산 구하는 방법

<img width="145" alt="image" src="https://user-images.githubusercontent.com/87634136/178137948-5bbb6527-5be9-4a79-8d12-2ce19ed3097b.png">

--> 공분산은 X의 편차와 Y의 편차를 곱한 것의 평균


-> 위의 식을 더 간편하게 정리하자면

<img width="162" alt="image" src="https://user-images.githubusercontent.com/87634136/178137952-a78efcbf-d864-4822-a9fb-0c041812ef7b.png">


- 공분산의 문제점

: X와 Y의 단위의 크기에 영향을 받는다

ex) 100점 만점인 두 과목의 점수 공분산은 별로 상관성이 부족하지만 100점 만점이기 때문에 큰 값이 나오고, 10점짜리 두 과목의 점수 공분산은 상관성이 아주 높지만 10점 만점이기 때문에 작은 값이 나온다.

: 공분산의 문제점 => 보완 => 상관계수 (Correlation)


- 상관계수 (Correlation)

: 확률변수의 절대적 크기에 영향을 받지 않도록 단위화 시켰다고 생각하면 된다.

-> 상관계수의 정의

<img width="119" alt="image" src="https://user-images.githubusercontent.com/87634136/178137968-ab47e2b8-32e8-4ce9-8c30-7d66bf178e91.png">

-> 상관계수의 성질

1. 상관계수의 절대값은 1을 넘을 수 없다.

2. 확률변수 X, Y가 독립이라면 상관계수는 0이다.

3. X와 Y가 선형적 관계라면 상관계수는 1 or -1이다. 

양의 선형관계라면 1, 음의 선형관계라면 -1


< 공분산 행렬 >

: 각 데이터의 분산과 공분산을 이용해 만드는 공분산 행렬

<img width="265" alt="image" src="https://user-images.githubusercontent.com/87634136/178137996-5a59c802-05e6-4237-932d-8d6f382b74f6.png">

--> 공분산 행렬 -> 정사각행렬의 성분을 각 변수의 분산과 공분산으로 채운 것


->공분산 행렬의 데이터 분포

<img width="270" alt="image" src="https://user-images.githubusercontent.com/87634136/178138009-f51305ed-713e-4613-8c09-8b69671da807.png">


< 다변수 정규분포 >

DD차원 다변수정규분포(MVN: multivariate Gaussian normal distribution)의 확률밀도함수는 평균벡터 μ와 공분산행렬 Σ 라는 두 개의 모수를 가지며 다음과 같은 수식으로 정의한다.

<img width="263" alt="image" src="https://user-images.githubusercontent.com/87634136/178138021-1a712654-9db7-4fec-a432-8a6aa8e1b1b0.png">


- 기호의 의미

<img width="121" alt="image" src="https://user-images.githubusercontent.com/87634136/178138027-20c0bcec-f379-4330-b662-96a8b2710192.png">









**< 출처 >**
https://drhongdatanote.tistory.com/
https://datalabbit.tistory.com/
https://www.edwith.org/sutudy/lecture/29041?isDesc=false
https://songminkee.github.io/studyblog/statistics/2020/06/30/law_of_large_numbers.html
https://analysisbugs.tistory.com/8
https://m.blog.naver.com/mykepzzang/220835810657
http://kanggc.iptime.org/stat/chap8/chap8.pdf
http://www.uniwise.co.kr/pdfupload/lecture_upload/R201500153/stlsm_9.pdf
https://destrudo.tistory.com/15
http://matrix.skku.ac.kr/math4ai-intro/W11/
https://datascienceschool.net/02%20mathematics/08.06%20%EB%8B%A4%EB%B3%80%EC%88%98%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC.html

